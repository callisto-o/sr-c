# Shadowrocket: 2026-02-18 24:29:19
# Конфигурация для белых списков
[General]
# Обход системных сервисов (Appple, Push-уведомления)
bypass-system = true

# Белый список IP-CIDR которые идут в PROXY, все остальное в DIRECT.
tun-included-routes = 

# Домены, которым нужен реальный IP (NTP, Cloudflare и Google)
always-real-ip = time.*.com,ntp.*.com,*.cloudflareclient.com

# Перехват DNS-запросов на стандартном порту 53
hijack-dns = :53

# Список локальных адресов и доменов, которые всегда идут в DIRECT.
# Приложение видит трафик, но не обрабатывает правилами (пойдет через виртуальный интерфейс).
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,captive.apple.com

# Черный список IP-CIDR, которые идут в DIRECT, все остальное в PROXY.
# Трафик вообще не заходит в приложение (пойдет мимо виртуального интерфейса).
tun-excluded-routes = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32,239.255.255.250/32

# Основные DNS-серверы
dns-server = https://77.88.8.8/dns-query,https://common.dot.dns.yandex.net/dns-query

# Резервные DNS-серверы на случай сбоя основных
fallback-dns-server = h3://8.8.8.8/dns-query,h3://1.1.1.1/dns-query,quic://dns.adguard-dns.com,https://1.1.1.1/dns-query,https://8.8.8.8/dns-query,tls://8.8.8.8,tls://1.1.1.1,https://94.140.14.14/dns-query,system

# Использование ipv6 (false - отключено)
ipv6 = false

# Приоритет IPv6 над IPv4
prefer-ipv6 = false

# Использовать ли системный DNS для правил DIRECT (true - да)
dns-direct-system = true

# Использовать ли системный DNS автоматически, если основные упали (false — нет, строго следовать списку fallback-dns-server)
dns-fallback-system = false

# Авто-ответ на пинг (false - отключено)
# Когда игра или система проверяет пинг, Shadowrocket сам быстро отвечает "Я тут, связь есть", не гоняя пакет на далекий сервер.
icmp-auto-reply = false

# Защита от зацикливания
# Если правило URL Rewrite (переадресация) ведет в никуда или вызывает ошибку, Shadowrocket просто сбросит соединение
always-reject-url-rewrite = true

# Разрешать локальные IP в DNS ответах (важно для работы в домашней сети)
private-ip-answer = true

# Если прямой DNS запрос не прошел, пробовать отправить его через прокси
dns-direct-fallback-proxy = true

# Сбрасывать UDP-трафик, если выбранный прокси-узел его не поддерживает
udp-policy-not-supported-behaviour = REJECT

[Rule]
# Полная блокировка IPv6 трафика
IP-CIDR,FC00::/7
IP-CIDR,FE80::/10
IP-CIDR,::/0

RULE-SET,https://raw.githubusercontent.com/callisto-o/sr-c/refs/heads/main/reject.list,REJECT
RULE-SET,https://raw.githubusercontent.com/misha-tgshv/shadowrocket-configuration-file/main/rules/voice_ports.list,PROXY
RULE-SET,https://raw.githubusercontent.com/misha-tgshv/shadowrocket-configuration-file/main/rules/domains_community.list,PROXY
RULE-SET,https://raw.githubusercontent.com/HybridNetworks/whatsapp-cidr/refs/heads/main/WhatsApp/whatsapp_cidr_ipv4.list,PROXY,no-resolve
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Shadowrocket/Telegram/Telegram.list,PROXY
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Shadowrocket/Discord/Discord.list,PROXY
RULE-SET,https://github.com/toneywhitez/zkeen_rules/releases/latest/download/telegram_ips.list,PROXY,no-resolve
RULE-SET,https://github.com/toneywhitez/zkeen_rules/releases/latest/download/meta_ips.list,PROXY,no-resolve

DOMAIN,api.imem.app,PROXY
DOMAIN,api.swiftgram.app,PROXY

DOMAIN-SUFFIX,musical.ly,PROXY
DOMAIN-SUFFIX,google.com,PROXY
DOMAIN-SUFFIX,oaiusercontent.com,PROXY
DOMAIN-SUFFIX,whoer.net,PROXY
DOMAIN-SUFFIX,windscribe.com,PROXY
DOMAIN-SUFFIX,cdn-telegram.org,PROXY
DOMAIN-SUFFIX,comments.app,PROXY
DOMAIN-SUFFIX,contest.com,PROXY
DOMAIN-SUFFIX,graph.org,PROXY
DOMAIN-SUFFIX,legra.ph,PROXY
DOMAIN-SUFFIX,mbrx.app,PROXY
DOMAIN-SUFFIX,quiz.directory,PROXY
DOMAIN-SUFFIX,stel.com,PROXY
DOMAIN-SUFFIX,t.me,PROXY
DOMAIN-SUFFIX,tdesktop.com,PROXY
DOMAIN-SUFFIX,telega.one,PROXY
DOMAIN-SUFFIX,telegra.ph,PROXY
DOMAIN-SUFFIX,telegram-cdn.org,PROXY
DOMAIN-SUFFIX,telegram.dog,PROXY
DOMAIN-SUFFIX,telegram.me,PROXY
DOMAIN-SUFFIX,telegram.org,PROXY
DOMAIN-SUFFIX,telegram.space,PROXY
DOMAIN-SUFFIX,telegramdownload.com,PROXY
DOMAIN-SUFFIX,telesco.pe,PROXY
DOMAIN-SUFFIX,tg.dev,PROXY
DOMAIN-SUFFIX,tx.me,PROXY
DOMAIN-SUFFIX,usercontent.dev,PROXY
DOMAIN-SUFFIX,qwen.ai,PROXY
DOMAIN-SUFFIX,slack.com,PROXY
DOMAIN-SUFFIX,whox.is,PROXY
DOMAIN-SUFFIX,bootstrapcdn.com,PROXY
DOMAIN-SUFFIX,azure.com,PROXY
DOMAIN-SUFFIX,eppo.cloud,PROXY
DOMAIN-SUFFIX,exp-tas.com,PROXY
DOMAIN-SUFFIX,jquery.com,PROXY
DOMAIN-SUFFIX,botfaqtor.ru,PROXY

DOMAIN-KEYWORD,github,PROXY
DOMAIN-KEYWORD,perplexity,PROXY
DOMAIN-KEYWORD,deepseek,PROXY
DOMAIN-KEYWORD,nicegram,PROXY
DOMAIN-KEYWORD,vscode,PROXY
DOMAIN-KEYWORD,ishosting,PROXY
DOMAIN-KEYWORD,ibyteimg,PROXY
DOMAIN-KEYWORD,telegram,PROXY
DOMAIN-KEYWORD,pornhub,PROXY
DOMAIN-KEYWORD,phncdn,PROXY

# русские в proxy
DOMAIN-KEYWORD,2gis,PROXY
DOMAIN-KEYWORD,sberbank,PROXY
DOMAIN-KEYWORD,tinkoff,PROXY
DOMAIN-KEYWORD,tbank,PROXY
DOMAIN-KEYWORD,nalog,PROXY


####################################
# apple music
# Основные сервисы и API apple music
DOMAIN-SET,apple-music.list,PROXY
DOMAIN,music.apple.com,PROXY
DOMAIN,amp-api.music.apple.com,PROXY
DOMAIN,itunes.apple.com,PROXY
# Стриминг аудио и контент (CDN)
DOMAIN-SUFFIX,audio-ak-spotify-com.akamaized.net,PROXY
DOMAIN-SUFFIX,aaplimg.com,PROXY
DOMAIN-SUFFIX,apple-dns.net,PROXY
DOMAIN-KEYWORD,av-realtime,PROXY
# Авторизация и нативные функции
DOMAIN,bag.itunes.apple.com,PROXY
DOMAIN,play.itunes.apple.com,PROXY
DOMAIN,identity.apple.com,PROXY
# Обложки и медиа-ассеты
DOMAIN-SUFFIX,mzstatic.com,PROXY
# дополнительные (общие)
DOMAIN-SUFFIX,apple.com,PROXY
DOMAIN-SUFFIX,icloud.com,PROXY
DOMAIN-SUFFIX,itunes.com,PROXY
DOMAIN-SUFFIX,cdn-apple.com,PROXY
####################################


IP-CIDR,109.239.140.0/24,no-resolve
IP-CIDR,139.59.210.98/32,no-resolve
IP-CIDR,149.154.160.0/20,no-resolve
IP-CIDR,196.55.216.167/32,no-resolve
IP-CIDR,5.28.192.0/18,no-resolve
IP-CIDR,91.108.0.0/16,no-resolve
IP-ASN,211157,no-resolve
IP-ASN,44907,no-resolve
IP-ASN,59930,no-resolve
IP-ASN,62014,no-resolve
IP-ASN,62041,no-resolve

# Telegramm
IP-CIDR,91.108.4.0/22,PROXY
IP-CIDR,91.108.8.0/22,PROXY
IP-CIDR,91.108.12.0/22,PROXY
IP-CIDR,91.108.16.0/22,PROXY
IP-CIDR,91.108.20.0/22,PROXY
IP-CIDR,91.108.36.0/23,PROXY
IP-CIDR,91.108.38.0/23,PROXY
IP-CIDR,91.108.40.0/22,PROXY
IP-CIDR,91.108.56.0/22,PROXY
IP-CIDR,149.154.160.0/20,PROXY
IP-CIDR,185.76.151.0/24,PROXY

# WhatsApp
IP-CIDR,18.192.0.0/15,PROXY
IP-CIDR,18.194.0.0/15,PROXY
IP-CIDR,18.196.0.0/15,PROXY
IP-CIDR,18.198.0.0/15,PROXY
IP-CIDR,31.13.24.0/21,PROXY
IP-CIDR,31.13.64.0/18,PROXY
IP-CIDR,45.64.40.0/22,PROXY
IP-CIDR,66.220.144.0/20,PROXY
IP-CIDR,69.63.176.0/20,PROXY
IP-CIDR,69.171.224.0/19,PROXY
IP-CIDR,74.119.76.0/22,PROXY
IP-CIDR,103.4.96.0/22,PROXY
IP-CIDR,129.134.0.0/17,PROXY
IP-CIDR,157.240.0.0/16,PROXY
IP-CIDR,173.252.64.0/18,PROXY
IP-CIDR,179.60.192.0/22,PROXY
IP-CIDR,185.60.216.0/22,PROXY
IP-CIDR,204.15.20.0/22,PROXY
# Unique WhatsApp infrastructure
IP-CIDR,3.33.221.48/32,PROXY
IP-CIDR,3.33.252.61/32,PROXY
IP-CIDR,15.197.206.217/32,PROXY
IP-CIDR,15.197.210.208/32,PROXY
IP-CIDR,34.192.181.12/32,PROXY
IP-CIDR,34.193.38.112/32,PROXY
IP-CIDR,34.194.71.217/32,PROXY
IP-CIDR,34.194.255.230/32,PROXY
IP-CIDR,102.132.96.0/20,PROXY
IP-CIDR,163.70.128.0/18,PROXY

# TikTok
IP-CIDR,37.19.202.0/24,PROXY
IP-CIDR,2.23.0.0/16,PROXY
IP-CIDR,2.22.0.0/16,PROXY
IP-CIDR,95.100.0.0/16,PROXY

FINAL,DIRECT

[Host]
localhost = 127.0.0.1
